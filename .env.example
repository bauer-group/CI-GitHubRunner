# =============================================================================
# GitHub Runner - Self-Hosted Runner Configuration
# =============================================================================
# BAUER GROUP Self-Hosted GitHub Runner with Docker-in-Docker (DinD)
# Uses myoung34/github-runner:latest for ephemeral runners
# =============================================================================

# -----------------------------------------------------------------------------
# STACK IDENTIFICATION
# -----------------------------------------------------------------------------
# Name used as prefix for container/volume/network names
# Allows multiple deployments on same host without conflicts
STACK_NAME=github-runner

# Timezone for all services (affects log timestamps)
TIME_ZONE=Etc/UTC

# -----------------------------------------------------------------------------
# GITHUB CONFIGURATION (REQUIRED)
# -----------------------------------------------------------------------------
# Choose ONE of these authentication methods:

# Option 1: Personal Access Token (PAT) - Simplest setup
# Create with pre-selected scopes:
#   Organization runner: https://github.com/settings/tokens/new?scopes=repo,admin:org&description=Self-Hosted-Runner
#   Repository runner:   https://github.com/settings/tokens/new?scopes=repo&description=Self-Hosted-Runner
#
# IMPORTANT: admin:org grants full org admin access (not just runners!)
# For better security: Use GitHub App (Option 2)
GITHUB_ACCESS_TOKEN=ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Option 2: GitHub App (Recommended for production)
# Create at: https://github.com/organizations/{org}/settings/apps
# Or use: python3 scripts/setup-github-app.py (automated setup)
# Permissions: Organization > Self-hosted runners (Read & Write)
# APP_ID=123456
# APP_LOGIN=bauer-group
# APP_PRIVATE_KEY_FILE=/opt/GitHubRunner/github-app.pem  # Path to PEM file (absolute or ./relative)

# Runner scope: org (organization) or repo (single repository)
RUNNER_SCOPE=org

# For organization runners (RUNNER_SCOPE=org):
# Set ORG_NAME to your organization name (NOT the full URL)
ORG_NAME=bauer-group

# For repository runners (RUNNER_SCOPE=repo):
# Set REPO_URL to the full repository URL
# REPO_URL=https://github.com/bauer-group/your-repo

# -----------------------------------------------------------------------------
# RUNNER CONFIGURATION
# -----------------------------------------------------------------------------
# Runner name prefix (will be appended with random suffix for uniqueness)
RUNNER_NAME_PREFIX=self-hosted

# Runner group - MUST exist in GitHub before starting runners!
# Create at: https://github.com/organizations/{org}/settings/actions/runner-groups
# The "Default" group always exists, custom groups must be created manually.
# Examples: "Default", "Self-Hosted (BAUER GROUP)"
RUNNER_GROUP=Self-Hosted (BAUER GROUP)

# Additional runner labels (comma-separated)
# Note: Default labels (self-hosted, linux, x64) are set automatically
# Use in workflows: runs-on: [self-hosted, linux, docker]
# Or with group:    runs-on: { group: "Self-Hosted (BAUER GROUP)", labels: [linux, docker] }
RUNNER_LABELS=docker,28c-56g

# -----------------------------------------------------------------------------
# DOCKER-IN-DOCKER CONFIGURATION
# -----------------------------------------------------------------------------
# DinD image tag
DIND_IMAGE=dind

# Docker storage driver for DinD
# Options: overlay2 (default, recommended), vfs (slower but more compatible)
DOCKER_STORAGE_DRIVER=overlay2

# Docker MTU (adjust if network issues occur, default: 1500)
# Lower values (e.g., 1450) may be needed in some cloud environments
DOCKER_MTU=1500

# Enable BuildKit for faster builds
DOCKER_BUILDKIT=1

# -----------------------------------------------------------------------------
# RESOURCE LIMITS
# -----------------------------------------------------------------------------
# Only DinD needs limits - ALL Docker builds run there!
# Runner agents are lightweight (~200MB RAM) and don't need limits.
#
# Recommended: Give DinD most of your host resources
# Example for 64GB RAM / 32 CPU host:
DIND_MEMORY_LIMIT=56g
DIND_CPU_LIMIT=28

# Shared memory size for DinD (important for large builds)
DIND_SHM_SIZE=8g

# -----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# -----------------------------------------------------------------------------
# Maximum log file size
LOG_MAX_SIZE=50m

# Number of log files to keep
LOG_MAX_FILE=5

# -----------------------------------------------------------------------------
# OPTIONAL: HTTP PROXY CONFIGURATION
# -----------------------------------------------------------------------------
# Configure if runners need to access internet through proxy
# HTTP_PROXY=http://proxy.example.com:8080
# HTTPS_PROXY=http://proxy.example.com:8080
# NO_PROXY=localhost,127.0.0.1,.local
