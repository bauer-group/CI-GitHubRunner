# =============================================================================
# GitHub Runner - GitHub App Authentication Override
# =============================================================================
# Use this file when authenticating with a GitHub App instead of a PAT.
#
# Usage:
#   docker compose -f docker-compose.yml -f docker-compose.app-auth.yml up -d
#
# Or set COMPOSE_FILE in your environment:
#   export COMPOSE_FILE=docker-compose.yml:docker-compose.app-auth.yml
#
# APP_PRIVATE_KEY in .env = Host path to PEM file (e.g., ./github-app.pem)
# Container path is fixed: /opt/github-app.pem
# =============================================================================

services:
  agent:
    environment:
      # Fixed container path - overrides base config
      APP_PRIVATE_KEY: /opt/github-app.pem
    volumes:
      - tool-cache:/opt/hostedtoolcache
      # Mount host PEM file to fixed container path
      - ${APP_PRIVATE_KEY:-./github-app.pem}:/opt/github-app.pem:ro
